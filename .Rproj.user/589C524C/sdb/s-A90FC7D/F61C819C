{
    "contents" : "\\name{lavaan.survey}\n\\alias{lavaan.survey}\n\\title{\n\tComplex survey analysis of structural equation models (SEM)\n}\n\\description{\n\tTakes a lavaan fit object and a complex survey design object as input\n\tand returns a structural equation modeling analysis based on the fit \n\tobject, where the complex sampling design is taken into account. \n\t\n\tThe structural equation model parameter estimates and standard errors\n\tare design-based (``aggregated modeling''). \n\tSee Satorra and Muthen (1995) for details on the procedure.\n}\n\\usage{\nlavaan.survey(lavaan.fit, survey.design, \n\t     estimator=c(\"MLM\", \"MLMV\", \"MLMVS\", \"WLS\", \"DWLS\", \"ML\"),\n\t     estimator.gamma=c(\"default\",\"Yuan-Bentler\"))\n\t \n\n}\n%- maybe also 'usage' for other objects documented here.\n\\arguments{\n  \\item{lavaan.fit}{\n\tA \\code{\\linkS4class{lavaan}} object resulting from a lavaan call. \n\t\n\tSince this is the estimator that will be used in the complex sample\n\testimates, for comparability it can be convenient to use the same estimator in the call\n\tgenerating the lavaan fit object as in the lavaan.survey call. By default\n\tthis is \"MLM\".\n}\n  \\item{survey.design}{\n\tAn  \\code{\\link{svydesign}} object resulting from a call to \n\tsvydesign in the survey package. This allows for incorporation of\n\tclustering, stratification, unequal probability weights, finite\n\tpopulation correction, and multiple imputation. \n\tSee the survey documentation for more information.\n}\n   \\item{estimator}{\n   \t\tThe estimator used determines how parameter estimates are obtained, \n   \t\thow standard errors are calculated, and how the test statistic and \n   \t\tall measures derived from it are adjusted. See \\code{\\link{lavaan}}.\n   \t\t\n \t\tThe default estimator is MLM. It is recommended to use one\n\t\tof the ML estimators.\n   }\n   \\item{estimator.gamma}{\n\tWhether to use the usual estimator of Gamma as given by svyvar (the variance-covariance\n\tmatrix of the observed variances and covariances), or apply some kind\n\tof smoothing or adjustment. Currently the only other option is the\n\tYuan-Bentler adjustment based on model residuals.\n   }\n}\n\\details{\n\tThe user specifies a complex sampling design with the survey package's\n\t\\code{\\link{svydesign}} function, and a structural equation model with\n\t\\code{\\link{lavaan}}.\n\t\n\tWhen calling lavaan.survey, the following steps are then completed:\n\t\\enumerate{\n\t\t\\item The covariance matrix of the observed variables\n\t\t(or matrices in the case of multiple\n\t\tgroup analysis) is estimated using the svyvar command from the\n\t\tsurvey package. \n\t       \t\\item The asymptotic covariance matrix of the variances and\n\t\tcovariances is obtained from the svyvar output  (the \"Gamma\"\n\t\tmatrix)\n\t\t\\item The last step depends on the estimation method chosen:\n\t\t\n\t\t\\enumerate{\n\t\t\\item[MLM, MLMV, MLMVS] The lavaan model is re-fit using Maximum Likelihood\n\t\twith the covariance matrix as data. After normal-theory ML\n\t\testimation, the standard errors (vcov matrix), likelihood ratio\n\t\t(\"chi-square\") statistic, and all derived fit indices and\n\t\tstatistics are adjusted for the complex sampling design using\n\t\tthe Gamma matrix. I.e. the Satorra-Bentler (SB) corrections are\n\t\tobtained (\"MLM\" estimation in lavaan terminology).\n\t\t\\item[WLS, DWLS] The lavaan model is re-fit using Weighted Least Squares\n\t\twith the covariance matrix as data, and the Moore-Penrose inverse\n\t\tof the Gamma matrix as estimation weights. If DWLS is chosen\n\t\tonly the diagonal of the weight matrix is used.\n\t\t}\n\t}\n\n\n}\n\\value{\n\tAn object of class \\code{\\linkS4class{lavaan}}, where the estimates, \n\tstandard errors, vcov matrix, chi-square statistic, and fit measures \n\tbased on the chi-square take into account the complex survey \n\tdesign. Several methods are available for \\code{\\linkS4class{lavaan}} \n\tobjects, including a \\code{summary} method.}\n\\references{\n\tOberski, D. and Saris, W. (2012). A model-based procedure to evaluate\n\t    the relative effects of different TSE components on structural equation\n\t    model parameter estimates. Presentation given at the International\n\t    Total Survey Error Workshop in Santpoort, the Netherlands. \n\t    \\url{http://daob.org/}\n\n\tSatorra, A., & Bentler, P. M. (1994). Corrections to test statistics\n\t\tand standard errors in covariance structure analysis. \n\n\tSatorra, A., and Muthen, B. (1995). Complex sample data in structural\n\t   equation modeling. Sociological methodology, 25, 267-316.\n}\n\\author{\n\tDaniel Oberski - \\url{http://daob.org} - \\email{daniel.oberski@gmail.com}\n}\n\\note{\n    Currently only continuous observed variables are implemented.\n}\n\n%% ~Make other sections like Warning with \\section{Warning }{....} ~\n\n\\seealso{\n\t\\code{\\link{svydesign}}\n\t\\code{\\link{svyvar}}\n\t\\code{\\link{lavaan}}\n}\n\\examples{\n###### A single group example #######\n\ndata(ess.dk)\n\ndk.model <- \"\n  socialTrust ~ 1 + systemTrust + fearCrime\n  systemTrust ~ 1 + socialTrust + efficacy\n  socialTrust ~~ systemTrust\n\"\nlavaan.fit <- lavaan(dk.model, data=ess.dk, auto.var=TRUE, estimator=\"MLM\")\nsummary(lavaan.fit)\nsurvey.design <- svydesign(ids=~intnum, data=ess.dk)\n\nsurvey.fit <- lavaan.survey(lavaan.fit=lavaan.fit, survey.design=survey.design)\nsummary(survey.fit)\n\n\n\t\n###### A multiple group example #######\n\ndata(HolzingerSwineford1939)\n\n# The Holzinger and Swineford (1939) example - some model with complex restrictions\nHS.model <- ' visual  =~ x1 + x2 + c(lam31, lam31)*x3\n              textual =~ x4 + x5 + c(lam62, lam62)*x6\n              speed   =~ x7 + x8 + c(lam93, lam93)*x9 \n             speed ~ textual \n             textual ~ visual'\n\n# Fit multiple group per school\nfit <- lavaan(HS.model, data=HolzingerSwineford1939,\n              auto.var=TRUE, auto.fix.first=TRUE, group=\"school\",\n              auto.cov.lv.x=TRUE, estimator=\"MLM\")\nsummary(fit, fit.measures=TRUE)\n\n# Create fictional clusters in the HS data\nset.seed(20121025)\nHolzingerSwineford1939$clus <- sample(1:100, size=nrow(HolzingerSwineford1939), replace=TRUE)\nsurvey.design <- svydesign(ids=~clus, data=HolzingerSwineford1939)\n\nsummary(fit.survey <- lavaan.survey(fit, survey.design))\n\n\n}\n% Add one or more standard keywords, see file 'KEYWORDS' in the\n% R documentation directory.\n\\keyword{survey}\n\\keyword{models}\n\\keyword{regression}\n\\keyword{robust}\n\\keyword{multivariate}\n",
    "created" : 1360150046166.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1909001223",
    "id" : "F61C819C",
    "lastKnownWriteTime" : 1354177508,
    "path" : "~/Dropbox/Development/lavaan.survey/lavaan.survey/man/lavaan.survey.Rd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_doc"
}